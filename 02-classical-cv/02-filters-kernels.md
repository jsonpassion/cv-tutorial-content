# í•„í„°ì™€ ì»¤ë„

> ë¸”ëŸ¬, ìƒ¤í”„ë‹, ì—ì§€ ê²€ì¶œ í•„í„°

## ê°œìš”

ì‚¬ì§„ì´ íë¦¿í•  ë•Œ ì„ ëª…í•˜ê²Œ ë§Œë“¤ê±°ë‚˜, ë°˜ëŒ€ë¡œ ë¶€ë“œëŸ½ê²Œ ë§Œë“œëŠ” ê²ƒ. ì´ ëª¨ë“  ê²ƒì€ ì´ë¯¸ì§€ ìœ„ì— ì‘ì€ ìˆ«ì ê²©ìë¥¼ ìŠ¬ë¼ì´ë”©í•˜ë©° ê³„ì‚°í•˜ëŠ” **í•„í„°ë§**ìœ¼ë¡œ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ ì„¹ì…˜ì—ì„œëŠ” í•„í„°(ì»¤ë„)ê°€ ë¬´ì—‡ì´ë©°, ì–´ë–»ê²Œ ì´ë¯¸ì§€ë¥¼ ë³€í™˜í•˜ëŠ”ì§€ ë°°ì›ë‹ˆë‹¤.

**ì„ ìˆ˜ ì§€ì‹**: [OpenCV ì‹œì‘í•˜ê¸°](./01-opencv-basics.md) â€” imread, imshow ê¸°ë³¸ ì‚¬ìš©ë²•
**í•™ìŠµ ëª©í‘œ**:
- ì»¤ë„(í•„í„°)ê³¼ í•©ì„±ê³± ì—°ì‚°ì˜ ì›ë¦¬ë¥¼ ì´í•´í•œë‹¤
- ë¸”ëŸ¬, ìƒ¤í”„ë‹ í•„í„°ë¥¼ ì§ì ‘ ì ìš©í•  ìˆ˜ ìˆë‹¤
- ì»¤ë„ ê°’ì— ë”°ë¼ ê²°ê³¼ê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ ê°ì„ ì¡ëŠ”ë‹¤

## ì™œ ì•Œì•„ì•¼ í• ê¹Œ?

ì´ë¯¸ì§€ í•„í„°ë§ì€ ì»´í“¨í„° ë¹„ì „ì˜ **ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” ì—°ì‚°**ì…ë‹ˆë‹¤. ë…¸ì´ì¦ˆ ì œê±°, ì—ì§€ ê²€ì¶œ, ì´ë¯¸ì§€ ì„ ëª…í™” ë“± ëª¨ë“  ì „í†µì  CV ê¸°ë²•ì˜ ê·¼ê°„ì´ë©°, ë‚˜ì•„ê°€ ë”¥ëŸ¬ë‹ì˜ **CNN(í•©ì„±ê³± ì‹ ê²½ë§)**ì´ í•™ìŠµí•˜ëŠ” ê²ƒë„ ê²°êµ­ "ìµœì ì˜ í•„í„°ë¥¼ ì°¾ëŠ” ê²ƒ"ì…ë‹ˆë‹¤. í•„í„°ë¥¼ ì´í•´í•˜ë©´ CNNì´ ì™œ ë™ì‘í•˜ëŠ”ì§€ë„ ìì—°ìŠ¤ëŸ½ê²Œ ì´í•´ë©ë‹ˆë‹¤.

## í•µì‹¬ ê°œë…

### 1. ì»¤ë„(Kernel)ì´ë€?

> ğŸ’¡ **ë¹„ìœ **: ì´ë¯¸ì§€ ìœ„ì— **ì‘ì€ ë‹ë³´ê¸°**ë¥¼ ì˜¬ë ¤ë†“ê³ , ë‹ë³´ê¸°ê°€ ë¹„ì¶”ëŠ” ë²”ìœ„ì˜ í”½ì…€ë“¤ì„ ê·œì¹™ì— ë”°ë¼ ê³„ì‚°í•´ ìƒˆ ê°’ì„ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ë‹ë³´ê¸°ê°€ **ì»¤ë„**(ë˜ëŠ” í•„í„°)ì´ê³ , ê³„ì‚° ê·œì¹™ì´ ì»¤ë„ì— ë‹´ê¸´ **ìˆ«ì**ì…ë‹ˆë‹¤.

ì»¤ë„ì€ ë³´í†µ 3Ã—3, 5Ã—5, 7Ã—7 ê°™ì€ **í™€ìˆ˜ í¬ê¸°ì˜ ì‘ì€ ìˆ«ì ê²©ì**ì…ë‹ˆë‹¤. ì´ ê²©ìë¥¼ ì´ë¯¸ì§€ ìœ„ì—ì„œ í•œ ì¹¸ì”© ì›€ì§ì´ë©°, ê²¹ì¹˜ëŠ” í”½ì…€ë“¤ê³¼ ê³±í•œ ë’¤ í•©ì‚°í•˜ì—¬ ìƒˆë¡œìš´ í”½ì…€ ê°’ì„ ë§Œë“­ë‹ˆë‹¤. ì´ ê³¼ì •ì„ **í•©ì„±ê³±(Convolution)**ì´ë¼ í•©ë‹ˆë‹¤.

**3Ã—3 í‰ê·  í•„í„°ì˜ ë™ì‘ ì˜ˆì‹œ:**

> ì»¤ë„ì˜ ê° ê°’(1/9)ê³¼ ëŒ€ì‘í•˜ëŠ” í”½ì…€ì„ ê³±í•œ ë’¤ ëª¨ë‘ ë”í•˜ë©´, ì£¼ë³€ 9ê°œ í”½ì…€ì˜ **í‰ê· **ì´ ë©ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ì´ë¯¸ì§€ê°€ ë¶€ë“œëŸ¬ì›Œ(ë¸”ëŸ¬)ì§‘ë‹ˆë‹¤.

| | ì—´1 | ì—´2 | ì—´3 |
|---|:---:|:---:|:---:|
| **í–‰1** | 1/9 | 1/9 | 1/9 |
| **í–‰2** | 1/9 | 1/9 | 1/9 |
| **í–‰3** | 1/9 | 1/9 | 1/9 |

> ì´ ì»¤ë„ì´ ì´ë¯¸ì§€ ìœ„ë¥¼ **ì™¼ìª½ ìœ„ë¶€í„° ì˜¤ë¥¸ìª½ ì•„ë˜ê¹Œì§€** í•œ ì¹¸ì”© ì´ë™í•˜ë©´ì„œ, ë§¤ë²ˆ ê²¹ì¹˜ëŠ” 9ê°œ í”½ì…€ì˜ í‰ê· ì„ êµ¬í•©ë‹ˆë‹¤.

### 2. ë¸”ëŸ¬(Blur) â€” ì´ë¯¸ì§€ë¥¼ ë¶€ë“œëŸ½ê²Œ

> ğŸ’¡ **ë¹„ìœ **: ìœ ë¦¬ì°½ì— ê¹€ì´ ì„œë¦° ê²ƒì²˜ëŸ¼, ê° í”½ì…€ì„ ì£¼ë³€ í”½ì…€ê³¼ **ì„ì–´ì„œ** ê²½ê³„ë¥¼ ë¶€ë“œëŸ½ê²Œ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤.

ë¸”ëŸ¬ëŠ” ë…¸ì´ì¦ˆ ì œê±°, ë°°ê²½ íë¦¬ê¸°, ì „ì²˜ë¦¬ ë“±ì— ì‚¬ìš©ë©ë‹ˆë‹¤.

```python
import cv2
import numpy as np

img = cv2.imread("photo.jpg")

# 1. í‰ê·  ë¸”ëŸ¬ (Box Blur) â€” ë‹¨ìˆœ í‰ê· 
blur_avg = cv2.blur(img, (5, 5))  # 5Ã—5 ì»¤ë„

# 2. ê°€ìš°ì‹œì•ˆ ë¸”ëŸ¬ â€” ì¤‘ì‹¬ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê°€ì¤‘ì¹˜ ë†’ìŒ
blur_gauss = cv2.GaussianBlur(img, (5, 5), 0)  # ì‹œê·¸ë§ˆ=0ì´ë©´ ìë™ ê³„ì‚°

# 3. ë¯¸ë””ì–¸ ë¸”ëŸ¬ â€” ì¤‘ì•™ê°’ ì‚¬ìš©, ì†Œê¸ˆ-í›„ì¶” ë…¸ì´ì¦ˆì— íš¨ê³¼ì 
blur_median = cv2.medianBlur(img, 5)  # ì»¤ë„ í¬ê¸° 5

# 4. ì–‘ë°©í–¥ í•„í„° â€” ì—ì§€ëŠ” ë³´ì¡´í•˜ë©´ì„œ ë¸”ëŸ¬
blur_bilateral = cv2.bilateralFilter(img, 9, 75, 75)
```

**ë¸”ëŸ¬ ì¢…ë¥˜ ë¹„êµ:**

| ë¸”ëŸ¬ ì¢…ë¥˜ | íŠ¹ì§• | ì¥ì  | ë‹¨ì  |
|----------|------|------|------|
| **í‰ê·  ë¸”ëŸ¬** | ì£¼ë³€ í”½ì…€ ë‹¨ìˆœ í‰ê·  | ë¹ ë¥´ê³  ê°„ë‹¨ | ì—ì§€ê¹Œì§€ ë­‰ê°œì§ |
| **ê°€ìš°ì‹œì•ˆ ë¸”ëŸ¬** | ì¤‘ì‹¬ì— ë†’ì€ ê°€ì¤‘ì¹˜ | ìì—°ìŠ¤ëŸ¬ìš´ ë¸”ëŸ¬ | ì—ì§€ ì•½ê°„ ì†ìƒ |
| **ë¯¸ë””ì–¸ ë¸”ëŸ¬** | ì¤‘ì•™ê°’ ì‚¬ìš© | ì†Œê¸ˆ-í›„ì¶” ë…¸ì´ì¦ˆ ì œê±°ì— íƒì›” | ì—°ì‚° ëŠë¦¼ |
| **ì–‘ë°©í–¥ í•„í„°** | ì—ì§€ ë³´ì¡´ ë¸”ëŸ¬ | ì—ì§€ëŠ” ì‚´ë¦¬ê³  ë©´ì€ ë¶€ë“œëŸ½ê²Œ | ê°€ì¥ ëŠë¦¼ |

### 3. ìƒ¤í”„ë‹(Sharpening) â€” ì´ë¯¸ì§€ë¥¼ ì„ ëª…í•˜ê²Œ

> ğŸ’¡ **ë¹„ìœ **: íë¦¿í•œ ì‚¬ì§„ì˜ **ê²½ê³„ ë¶€ë¶„ì„ ê°•ì¡° í‘œì‹œ**í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì›ë˜ ì´ë¯¸ì§€ì—ì„œ ë¸”ëŸ¬ëœ ë²„ì „ì„ ë¹¼ë©´ "ê²½ê³„ ì •ë³´"ë§Œ ë‚¨ëŠ”ë°, ì´ê±¸ ì›ë³¸ì— ë‹¤ì‹œ ë”í•˜ë©´ ê²½ê³„ê°€ ê°•ì¡°ë©ë‹ˆë‹¤.

```python
import cv2
import numpy as np

img = cv2.imread("photo.jpg")

# ìƒ¤í”„ë‹ ì»¤ë„ ì§ì ‘ ì •ì˜
sharpen_kernel = np.array([
    [ 0, -1,  0],
    [-1,  5, -1],
    [ 0, -1,  0]
])

# ì»¤ë„ ì ìš© (filter2Dë¡œ ì„ì˜ì˜ ì»¤ë„ ì‚¬ìš© ê°€ëŠ¥)
sharpened = cv2.filter2D(img, -1, sharpen_kernel)
```

**ìƒ¤í”„ë‹ ì»¤ë„ í•´ì„:**

| | ì—´1 | ì—´2 | ì—´3 |
|---|:---:|:---:|:---:|
| **í–‰1** | 0 | -1 | 0 |
| **í–‰2** | -1 | **5** | -1 |
| **í–‰3** | 0 | -1 | 0 |

> ì¤‘ì•™ ê°’ì€ **5**(ìê¸° ìì‹  ê°•ì¡°), ìƒí•˜ì¢Œìš°ëŠ” **-1**(ì£¼ë³€ì„ ë¹¼ì¤Œ). ê²°ê³¼ì ìœ¼ë¡œ "ì£¼ë³€ê³¼ ë‹¤ë¥¸ ë¶€ë¶„"ì´ ë” ë‘ë“œëŸ¬ì§€ê²Œ ë©ë‹ˆë‹¤. ëª¨ë“  ê°’ì˜ í•©ì´ 1ì´ë¯€ë¡œ ì „ì²´ ë°ê¸°ëŠ” ìœ ì§€ë©ë‹ˆë‹¤.

### 4. `cv2.filter2D()` â€” ë‚˜ë§Œì˜ ì»¤ë„ ë§Œë“¤ê¸°

ì–´ë–¤ ìˆ«ì ê²©ìë“  ì»¤ë„ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. OpenCVì˜ `filter2D()`ëŠ” ì‚¬ìš©ì ì •ì˜ ì»¤ë„ì„ ì´ë¯¸ì§€ì— ì ìš©í•©ë‹ˆë‹¤.

```python
import cv2
import numpy as np

img = cv2.imread("photo.jpg")

# ì— ë³´ìŠ¤ íš¨ê³¼ ì»¤ë„
emboss_kernel = np.array([
    [-2, -1, 0],
    [-1,  1, 1],
    [ 0,  1, 2]
])
embossed = cv2.filter2D(img, -1, emboss_kernel)

# ê°•í•œ ë¸”ëŸ¬ ì»¤ë„ (7Ã—7)
big_blur = np.ones((7, 7), dtype=np.float32) / 49
blurred = cv2.filter2D(img, -1, big_blur)
```

### 5. ì»¤ë„ í¬ê¸°ì˜ íš¨ê³¼

ì»¤ë„ì´ í´ìˆ˜ë¡ ë” ë§ì€ ì£¼ë³€ í”½ì…€ì„ ê³ ë ¤í•˜ë¯€ë¡œ íš¨ê³¼ê°€ ê°•í•´ì§‘ë‹ˆë‹¤.

| ì»¤ë„ í¬ê¸° | ê³ ë ¤ í”½ì…€ ìˆ˜ | ë¸”ëŸ¬ ê°•ë„ | ì—°ì‚° ë¹„ìš© |
|----------|------------|----------|----------|
| 3Ã—3 | 9ê°œ | ì•½í•¨ | ë‚®ìŒ |
| 5Ã—5 | 25ê°œ | ì¤‘ê°„ | ì¤‘ê°„ |
| 7Ã—7 | 49ê°œ | ê°•í•¨ | ë†’ìŒ |
| 11Ã—11 | 121ê°œ | ë§¤ìš° ê°•í•¨ | ë§¤ìš° ë†’ìŒ |

```python
import cv2

img = cv2.imread("photo.jpg")

# ì»¤ë„ í¬ê¸°ë³„ ê°€ìš°ì‹œì•ˆ ë¸”ëŸ¬ ë¹„êµ
for ksize in [3, 7, 15, 31]:
    blurred = cv2.GaussianBlur(img, (ksize, ksize), 0)
    print(f"ì»¤ë„ {ksize}Ã—{ksize}: ê²°ê³¼ shape = {blurred.shape}")
```

## ì‹¤ìŠµ: ì§ì ‘ í•´ë³´ê¸°

### ë‹¤ì–‘í•œ í•„í„° íš¨ê³¼ í•œëˆˆì— ë¹„êµ

```python
import cv2
import numpy as np

img = cv2.imread("photo.jpg")

# ì—¬ëŸ¬ í•„í„°ë¥¼ í•œ ë²ˆì— ì ìš©
filters = {
    "ì›ë³¸": img,
    "í‰ê·  ë¸”ëŸ¬ 5x5": cv2.blur(img, (5, 5)),
    "ê°€ìš°ì‹œì•ˆ ë¸”ëŸ¬ 5x5": cv2.GaussianBlur(img, (5, 5), 0),
    "ë¯¸ë””ì–¸ ë¸”ëŸ¬ 5": cv2.medianBlur(img, 5),
    "ìƒ¤í”„ë‹": cv2.filter2D(img, -1, np.array([[0,-1,0],[-1,5,-1],[0,-1,0]])),
}

# ê° ê²°ê³¼ì˜ í”½ì…€ í†µê³„ í™•ì¸
for name, result in filters.items():
    print(f"{name:20s} | mean={result.mean():.1f}, std={result.std():.1f}")
```

## í•µì‹¬ ì •ë¦¬

| ê°œë… | ì„¤ëª… |
|------|------|
| **ì»¤ë„(Kernel)** | ì´ë¯¸ì§€ì— ì ìš©í•˜ëŠ” ì‘ì€ ìˆ«ì ê²©ì (=í•„í„°) |
| **í•©ì„±ê³±(Convolution)** | ì»¤ë„ì„ ì´ë¯¸ì§€ ìœ„ì—ì„œ ìŠ¬ë¼ì´ë”©í•˜ë©° ê³±-í•© ì—°ì‚° |
| **ë¸”ëŸ¬** | ì£¼ë³€ í”½ì…€ê³¼ ì„ì–´ ë¶€ë“œëŸ½ê²Œ. ë…¸ì´ì¦ˆ ì œê±° ë“±ì— í™œìš© |
| **ìƒ¤í”„ë‹** | ê²½ê³„(ì—ì§€)ë¥¼ ê°•ì¡°í•´ ì„ ëª…í•˜ê²Œ |
| **filter2D()** | ì‚¬ìš©ì ì •ì˜ ì»¤ë„ì„ ì ìš©í•˜ëŠ” OpenCV í•¨ìˆ˜ |
| **ì»¤ë„ í¬ê¸°** | í´ìˆ˜ë¡ íš¨ê³¼ ê°•í•¨, ëŒ€ì‹  ì—°ì‚° ë¹„ìš© ì¦ê°€ |

## ë‹¤ìŒ ì„¹ì…˜ ë¯¸ë¦¬ë³´ê¸°

í•„í„°ê°€ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì•Œì•˜ìœ¼ë‹ˆ, ì´ì œ ê°€ì¥ ìœ ìš©í•œ í•„í„° ì¤‘ í•˜ë‚˜ì¸ **ì—ì§€ ê²€ì¶œ**ì„ ê¹Šì´ íŒŒë³´ê² ìŠµë‹ˆë‹¤. ë‹¤ìŒ ì„¹ì…˜ **[ì—ì§€ ê²€ì¶œ](./03-edge-detection.md)**ì—ì„œëŠ” Sobel, Canny ë“± ì´ë¯¸ì§€ì˜ ìœ¤ê³½ì„ ì„ ì°¾ëŠ” ê¸°ë²•ì„ ë°°ì›ë‹ˆë‹¤.

## ì°¸ê³  ìë£Œ

- [OpenCV ê³µì‹ íŠœí† ë¦¬ì–¼ - Smoothing Images](https://docs.opencv.org/4.x/d4/d13/tutorial_py_filtering.html) - ë¸”ëŸ¬ í•„í„° ê³µì‹ ê°€ì´ë“œ
- [OpenCV ê³µì‹ ë¸”ë¡œê·¸ - Image Filtering using Convolution](https://opencv.org/blog/image-filtering-using-convolution-in-opencv/) - í•©ì„±ê³± í•„í„°ë§ì˜ ì›ë¦¬ì™€ ì½”ë“œ
- [LearnOpenCV - Image Filtering Using Convolution](https://learnopencv.com/image-filtering-using-convolution-in-opencv/) - ì»¤ë„ë³„ ì‹œê°ì  ë¹„êµì™€ ìƒì„¸ ì„¤ëª…
- [Analytics Vidhya - Sharpening An Image using OpenCV](https://www.analyticsvidhya.com/blog/2021/08/sharpening-an-image-using-opencv-library-in-python/) - ìƒ¤í”„ë‹ í•„í„° ì„¤ëª…ê³¼ êµ¬í˜„
